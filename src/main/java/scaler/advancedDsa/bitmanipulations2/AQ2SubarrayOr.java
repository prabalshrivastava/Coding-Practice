package scaler.advancedDsa.bitmanipulations2;

public class AQ2SubarrayOr {
    //    Problem Description
//    You are given an array of integers A of size N.
//    The value of a subarray is defined as BITWISE OR of all elements in it.
//    Return the sum of value of all subarrays of A % 109 + 7.
//    Problem Constraints
//    1 <= N <= 105
//            1 <= A[i] <= 108
//    Input Format
//    The first argument given is the integer array A.
//            Output Format
//    Return the sum of Value of all subarrays of A % 109 + 7.
//    Example Input
//    Input 1:
//    A = [1, 2, 3, 4, 5]
//    Input 2:
//    A = [7, 8, 9, 10]
//    Example Output
//    Output 1:
//            71
//    Output 2:
//            110
//    Example Explanation
//    Explanation 1:
//    Value([1]) = 1
//    Value([1, 2]) = 3
//    Value([1, 2, 3]) = 3
//    Value([1, 2, 3, 4]) = 7
//    Value([1, 2, 3, 4, 5]) = 7
//    Value([2]) = 2
//    Value([2, 3]) = 3
//    Value([2, 3, 4]) = 7
//    Value([2, 3, 4, 5]) = 7
//    Value([3]) = 3
//    Value([3, 4]) = 7
//    Value([3, 4, 5]) = 7
//    Value([4]) = 4
//    Value([4, 5]) = 5
//    Value([5]) = 5
//    Sum of all these values = 71
//    Explanation 2:
//    Sum of value of all subarray is 110.
    public static void main(String[] args) {
        int[] input1A = {1, 2, 3, 4, 5};
        System.out.println(new AQ2SubarrayOr().solve(input1A));
        int[] input2A = {7, 8, 9, 10};
        System.out.println(new AQ2SubarrayOr().solve(input2A));
//Compiling your Code...
//> Success!
//Running Test Cases...
//> TestCase - Easy Success
//> TestCase - Hard Failed
//Wrong Answer
//Your program's output doesn't match the expected output. You can try testing your code with custom input and try putting debug statements in your code.
//Your submission failed for the following input
//(Following input test case is truncated. You can still do Run as Custom Input to test your code on the entire test case)
//A : [ 347148, 41171001, 52483357, 13831125, 31078369, 46467226, 22399388, 4890852, 5816291, 26239573, 11008165, 597007, 695545, 64681437, 96159611, 9401523, 7337799, 18525529, 35696434, 69604291, 33167134, 440227, 35786873, 39642252, 56681605, 42401269, 7339135, 105784, 84970744, 5857563, 7029061, 4033981, 30529, 80835681, 24531073, 28332031, 39633811, 23379501, 5511607, 15586365, 25256868, 40652137, 16111041, 36629217, 24796749, 16936417, 6120199, 8515907, 12737677, 19158590, 5388796, 44803463, 26850721, 9170963, 3991779, 43908646, 62814529, 36547831, 37768222, 33191665, 13113941, 79114397, 11226286, 20372971, 8271613, 8452501, 11966285, 13603381, 211438, 10705360, 12480160, 2969400, 44055006, 21555423, 36249949, 31763213, 22743181, 58794385, 2331901, 14501111, 47120191, 4094089, 10035685, 30691396, 15668701, 243277, 9561481, 18480517, 23506253, 43351313, 39202255, 105948, 50946085, 26137201, 3795310, 18241105, 11540985, 18900748, 28519271, 26762883, 32817345, 66574686, 3149401, 10143565, 847795, 6273793, 15246997, 13480279, 1549576, 13432900, 830002, 88510943, 38729601, 22885045, 5681681, 25338239, 7652023, 57320414, 1709585, 19569097, 25232803, 79090831, 49267979, 28345721, 13834717, 16336069, 234961, 867889, 31084733, 74842876, 1401399, 5443105, 3758239, 2785623, 119680, 30149133, 34637989, 3613401, 6526001, 6889608, 36852369, 33292390, 33752866, 2926171, 1191871, 10107489, 32374070, 9163425, 8980027, 41128270, 13258105, 20582657, 790876, 22489267, 70778793, 1168701, 6447655, 14874798, 37648885, 16911424, 18956914, 29094835, 616636, 1371553, 50586031, 28193617, 14076971, 13801915, 883037, 13093719, 18783116, 62806, 736897, 1731241, 33451629, 79532119, 29102373, 1993265, 709513, 15405770, 2490751, 546619, 3390997, 40514189, 174073, 58524541, 3079506, 26485219, 35890429, 8711025, 87035236, 58817579, 732251, 28589479, 54244737, 54827917, 695149, 14792311, 62119640, 61474687, 17644711, 4703685, 28660121, 26304961, 70267552, 19683399, 1383376, 2968733, 10201357, 12798042, 7454297, 56985466, 8259476, 1205865, 9287493, 24205601, 76803321, 2350263, 39155901, 195756, 55935361, 41517633, 18576751, 517161, 4376681, 17040376, 11139745, 16750717, 18176887, 12130055, 21118885, 8616353, 3527089, 22643601, 2041561, 42860571, 683551, 2173753, 5634595, 36600877, 55851853, 33353156, 42847499, 14770876, 10852713, 46203961, 34247725, 565309, 12186358, 492376, 10440641, 50335433, 1639781, 6947482, 35561818, 1752561, 48205961, 331445, 4203941, 33166799, 6941701, 67883725, 25153556, 1772401, 39007463, 6356281, 21745669, 33084517, 5439232, 27932851, 10828881, 22100313, 61508701, 9670145, 6679261, 56773201, 39571156, 1788097, 15214483, 28621783, 30541328, 36217710, 8751713, 1077105, 23627033, 6404986, 18262568, 19305386, 58584989, 22627081, 14292987, 34886657, 46391689, 6365634, 7502317, 6473182, 1489486, 190817, 13735151, 4761667, 24442295, 479676, 11416676, 25349271, 3144685, 9280516, 28482301, 6155580, 5995663, 10696159, 11073109, 1004081, 3815177, 1764301, 29306734, 47846026, 4593605, 6674848, 1135473, 14792137, 22175209, 372521, 63001, 1718981, 5015845, 5637841, 12140440, 259521, 78946651, 24587734, 30818551, 87113843, 58307741, 2571353, 2934266, 9065161, 11480785, 32557988, 2295201, 55724125, 72138245, 9047748, 61701648, 7599961, 71676463, 3652278, 1866846, 32786297, 32620225, 19534529, 17162761, 32782269, 658951, 27325061, 24186090, 1309813, 3251524, 13483279, 19560711, 61709361, 11992889, 6956148, 50890065, 16783777, 3903751, 7656526, 430867, 1369207, 13074433, 23363945, 3131476, 13460041, 65484189, 9308479, 33948216, 49269817, 24467101, 17873461, 65462661, 79909124, 5062305, 36382225, 83668911, 70326804, 15599922, 11150401, 22343476, 43205, 11164537, 7760692, 15569368, 23634370, 2131097, 1252481, 2146519, 8839153, 2860741, 22599008, 8036601, 5286117, 3551689, 17885911, 36492031, 55462538, 7035553, 33331358, 10756863, 24497521, 9044869, 5546276, 355356, 24205305, 81676761, 26615689, 63897476, 7345833, 9880257, 1962157, 27340218, 16118821, 6142313, 871876, 39626341, 43291777, 4879117, 54918913, 3298369, 653111, 1147966, 64531431, 9300876, 11038483, 15988501, 9251709, 315230, 4888033, 29106097, 12178783, 41814103, 26825569, 166353, 9761522, 28635053, 9936001, 9038845, 16827751, 7164305, 6995429, 66623488, 17456023, 42003573, 4683147, 1496281, 37398047, 35892640, 1004403, 23591953, 11914, 19024046, 15557569, 14265406, 37435123, 16163237, 57927171, 9107875, 24982189, 25705788, 7982536, 43786254, 272601, 24874345, 31802156, 35597326, 25314871, 1969057, 15792229, 4320351, 21406617, 82249701, 38925492, 13625086, 41934781, 2421525, 32340965, 86507685, 48905, 17028391, 2348450, 145153, 34401601, 9558836, 2114155, 3821712, 26427136, 1788601, 54466205, 22472701, 15529138, 374881, 260885, 10187177, 52523657, 79183506, 60158017, 58068617, 78747943, 76533485, 7619241, 10006903, 28628145, 3863236, 78016447, 28075685, 4836691, 63433614, 10900009, 52199437, 8213450, 3522773, 7531681, 28012227, 14522705, 2960971, 91483393, 5633631, 1167585, 27806593, 584935, 51241563, 45822289, 7358741, 39406852, 52912675, 6856989, 19132183, 10149257, 49495447, 4363477, 9617233, 11920226, 6119327, 5327815, 32087341, 42743201, 5815123, 3741697, 2096281, 38041126, 83826055, 19615393, 14033947, 22443629, 28831681, 30809326, 150683, 4248801, 49205321, 8543111, 534601, 4141195, 20128109, 60527445, 11367973, 66192995, 22913626, 722476, 2964721, 8311381, 8564921, 85649835, 2180365, 19038482, 634591, 36180551, 2661751, 61693633, 10654687, 18272949, 5829097, 15828860, 22883176, 13349, 16621952, 86380081, 3185345, 65755886, 76629697, 70894489, 37785577, 63574513, 28995361, 80905507, 2462174, 560950, 46851736, 28860926, 9013201, 4213536, 9752625, 41868083, 1052701, 92810236, 17666830, 9338497, 44376099, 59082169, 3591221, 6794947, 3232321, 22545163, 31673181, 1192137, 40466011, 2114041, 47556013, 33958735, 15437254, 1092976, 60372301, 4782623, 2510773, 5750009, 20266337, 58249855, 19461321, 13781485, 11317407, 49365145, 4137603, 40461671, 71044201, 10514965, 15246685, 541545, 17307388, 51536827, 22170457, 59634685, 21734987, 9637969, 10243421, 8413793, 84698251, 28045465, 57762014, 12378363, 15146237, 2126389, 17091469, 52759957, 55340047, 5305565, 8937982, 7807361, 68314981, 1008407, 8459660, 22133851, 10825209, 29743851, 1733169, 3996790, 1993156, 75533410, 47245249, 2750761, 41374243, 20071230, 4050541, 6026685, 58143571, 17947452, 14370506, 393264, 2675021, 8656557, 75193963, 4221761, 12759959, 71120181, 7436939, 23608621, 31876417, 49262995, 2515155, 23677956, 1764379, 25456751, 74063173, 22506739, 16709629, 224347, 89528716, 13207376, 10514197, 65483881, 20139841, 84744577, 9342721, 11739011, 15686191, 3475605, 14524097, 12802889, 2231737, 61137217, 12240505, 68728281, 11414209, 24805708, 13784616, 1152901, 6358177, 93811074, 38624043, 71215201, 98441461, 28023544, 20056841, 7456465, 11646581, 2269976, 46978855, 46397957, 41350773, 9101041, 2754481, 23753266, 13559701, 29819073, 11392291, 11012863, 9007968, 14090, 2425141, 4881977, 64437781, 4146903, 2712403, 548392, 26526529, 2663041, 1657137, 55073932, 13999591, 8702505, 9718143, 79015460, 3051841, 7772330, 36907313, 14943933, 33751603, 1133353, 3357901, 2349497, 636481, 64680337, 11336009, 25463081, 60742021, 2140563, 18492228, 3700591, 68260996, 72347137, 1010685, 18102583, 20836751, 14942104, 12222596, 12522329, 6969948, 9927961, 11159545, 7671797, 74606507, 849241, 7113844, 60205657, 5571887, 13820225, 10277310, 45901165, 34016335, 15925729, 5645179, 89228166, 47649294, 3873281, 2018037, 11631063, 56766711, 26718103, 1097461, 21654226, 23272894, 2779085, 28474921, 8977618, 415651, 34802776, 29207751, 12882046, 16122349, 52076025, 56640833, 41604405, 13830211, 15814198, 43441696, 41326699, 12762898, 40590369, 13107485, 79759, 65053677, 7006741, 46724041, 16442582, 3374045, 2093092, 22296311, 8838883, 50945393, 45826177, 26823556, 42366429, 75984931, 2441025, 49275283, 19190723, 4395471, 14602985, 26350497, 41203961, 56359829, 30966451, 20831240, 5440366, 3275269, 5065446, 53557603, 6747151, 5062948, 21888891, 64519996, 18137989, 21079873, 15228357, 56821831, 58738156, 75905, 37177481, 17189116, 12487795, 47401069, 15327289, 58558387, 22743013, 3767881, 26472853, 870257, 17677683, 6492256, 24410185, 72482209, 12431017, 35638021, 9280216, 41266715, 1718201, 48079324, 45120276, 1138441, 9672378, 28884829, 14359303, 34125721, 51923895, 1938193, 1257725, 3331246, 9968845, 1086863, 70082897, 47065001, 4085055, 52745, 24190596, 5239108, 20364313, 751108, 4050982, 71086483, 53517256, 1584313, 46238981, 779026, 7059885, 39492433, 12222009, 18358441, 29597441, 5239044, 3146969, 15002065, 61726721, 4490424, 2505478, 15029128, 16625921, 8180011, 52766201, 50983681, 48404876, 19573369, 32586205, 43874865, 3478201, 11519751, 5660371, 1982881, 957995, 40641, 11085841, 13523595, 66146041, 2262403, 80781361, 3575121, 2403801, 1968031, 14857909, 17783809, 78127741, 6281026, 16369633, 12748711, 3741907, 166363, 41726977, 44340625, 36106939, 25168501, 9201266, 6005256, 13999921, 8309822, 43622056, 75186142, 31965957, 8182958, 42160455, 519000, 8255881, 6099193, 7684428, 5779329, 2241431, 5240236, 2370279, 14171977, 8652421, 30639211, 12189481, 73658096, 78101871, 656788, 19687991, 23923675, 440371, 25092453, 18860905, 28701366, 28706471, 44484331, 9114106, 8252570, 8364647, 3891648, 10627911, 15172147, 42811273, 63126437, 9523393, 41567124, 26537961, 6767428, 4419325, 3546874, 21978264, 27525366, 25565346, 4261951, 33853303, 16581613, 24285826, 29648035, 52167079, 4267633, 10346155, 5679811, 329761, 4223207, 21284293, 173551, 3415245, 22677891, 4884463, 80763981, 47102216, 75863881, 2811751, 14404495, 38210096, 3600671, 6151393, 30141339, 14154241, 1129516, 64383775, 8031937, 57901801, 34525459, 2912113, 13016837, 18876958, 557613, 16986751, 21972637, 1222664, 3015068, 1554021, 11520061, 30177577, 9782881, 28796626, 9559617, 59202011, 19517, 27910480, 18706461, 11031553, 12667744, 4826111, 14938330, 4809904, 41350516, 35408305, 10405606, 9867065, 3941038, 72513816, 58219219, 21961037, 12461069, 39494223, 1934494, 33562463, 31181808, 23526315, 2580783, 5733703, 27316568, 11778201, 4759041, 28252471, 85875661, 13650015, 45003141, 25975171, 1922687, 5632371, 38401681, 67080869, 78055416, 16652476, 1728439, 4738462, 4827735, 45704278, 8692879, 50449, 13558521, 56435887, 79528681, 15251823, 54381526, 4187237, 12025781, 4020574, 30204021, 17276551, 36321153, 1247940, 8239551, 29622701, 16528413, 8091346, 4762370, 50471, 34356751, 3083663, 86402891, 554659, 29475127, 22715617, 2539659, 24120171, 11137, 30489691, 49129081, 15917863, 8115607, 567465, 5484995, 7279028, 47390806, 8378941, 28344441, 328486, 547793, 25575787, 8661039, 18188467, 3218849, 34125771, 1893937, 12555783, 25865596, 83799697, 82421571, 50676718, 25811863, 3537295, 41752009, 24505280, 4919937, 9118543, 69166701, 13835641, 53639293, 46992661, 75215617, 47909161, 10836021, 14812843, 11211196, 4791547, 73548325, 92033401, 83661007, 15688927, 34814297, 3248565, 4685367, 113686, 2696549, 34169140, 18287391, 26134669, 14464529, 79154361, 63198649, 12457261, 82191691, 40829971, 5607757, 4153138, 52209721, 27395042, 7... ]
//
//Test As Custom Input
//The expected return value:
//398980269
//Your function returned the following:
//425749286
//Final Verdict
//> Wrong Answer
    }

    public int solve(int[] A) {
        long ans = 0;
        for (int i = 0; i < 32; i++) {
            int totalNoOfSetBitsByAllSubarrays = (A.length * (A.length + 1)) / 2;
            int x = 0;
            for (int j = 0; j < A.length; j++) {
                if ((A[j] & 1 << i) == 0) {
                    x++;
                } else {
                    totalNoOfSetBitsByAllSubarrays = totalNoOfSetBitsByAllSubarrays - ((x * (x + 1)) / 2);
                    x = 0;
                }
            }
            totalNoOfSetBitsByAllSubarrays = totalNoOfSetBitsByAllSubarrays - ((x * (x + 1)) / 2);
            ans = (long) ((ans + ((long) totalNoOfSetBitsByAllSubarrays * (1 << i))) % (Math.pow(10, 9) + 7));
        }
        return (int) ((int) ans % (Math.pow(10, 9) + 7));
    }

}
